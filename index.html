<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>Caynana AI</title>
  <link rel="icon" href="data:," />
  <script src="https://accounts.google.com/gsi/client" async defer></script>

  <style>
    /* =========================================================
       1. GLOBAL RESET & VARS
       ========================================================= */
    :root{
      --gold:#ffb300;
      --pistachio:#bef264;
      --bg-dark:#000000;
      --panel-bg:#111111;
      --border: rgba(255,255,255,.12);
      
      /* Y√ºkseklik Tanƒ±mlarƒ± */
      --topbar-h: 60px;
      --footer-h: 50px; /* Alttaki linkler */
      --assist-h: 70px; /* ƒ∞kon barƒ± */
      --input-h: 80px;  /* Yazƒ± yazma alanƒ± */
      
      --bottom-total: calc(var(--footer-h) + var(--assist-h) + var(--input-h));
    }

    * { box-sizing:border-box; -webkit-tap-highlight-color:transparent; outline:none; }
    html, body { margin:0; padding:0; height:100%; width:100%; overflow:hidden; background:var(--bg-dark); color:#eee; font-family: sans-serif; }

    /* =========================================================
       2. GATING (Login olmadan gizlenecekler)
       ========================================================= */
    body:not(.is-logged) .app-view { display:none !important; }
    body.is-logged .login-view { display:none !important; }

    /* =========================================================
       3. TOPBAR
       ========================================================= */
    .topbar {
      position: absolute; top:0; left:0; right:0; height:var(--topbar-h);
      background: rgba(0,0,0,0.8); backdrop-filter: blur(10px);
      border-bottom: 1px solid var(--border);
      display:flex; align-items:center; justify-content:space-between;
      padding: 0 15px; z-index: 1000;
    }
    .hamb-btn { font-size:24px; background:none; border:none; color:#fff; cursor:pointer; }
    
    .brand { font-weight:900; font-size:18px; letter-spacing:1px; color:#fff; }
    .brand span { color:var(--gold); }

    .user-pill {
      display:flex; align-items:center; gap:8px;
      background: rgba(255,255,255,0.1); padding:4px 10px 4px 4px;
      border-radius: 30px; border:1px solid rgba(255,255,255,0.1);
    }
    .user-avatar-small {
      width:28px; height:28px; border-radius:50%; background:var(--pistachio);
      object-fit:cover;
    }
    .user-name-small { font-size:11px; font-weight:700; max-width:80px; overflow:hidden; white-space:nowrap; text-overflow:ellipsis; }

    /* =========================================================
       4. CHAT AREA
       ========================================================= */
    .chat-area {
      position: absolute;
      top: var(--topbar-h);
      left: 0; right: 0;
      bottom: var(--bottom-total); /* Alt paneller kadar bo≈üluk */
      overflow-y: auto;
      padding: 20px;
      display:flex; flex-direction:column; gap:15px;
    }
    .msg { max-width: 80%; padding:10px 14px; border-radius:14px; font-size:14px; line-height:1.4; }
    .msg.bot { align-self: flex-start; background: #222; border:1px solid var(--border); color:#ddd; border-top-left-radius:2px; }
    .msg.user { align-self: flex-end; background: var(--gold); color:#000; font-weight:600; border-top-right-radius:2px; }

    /* =========================================================
       5. BOTTOM DOCK (Asistan + Input + Linkler)
       ========================================================= */
    .bottom-dock {
      position: fixed; bottom:0; left:0; right:0;
      background: #000; z-index: 1100;
      border-top: 1px solid var(--border);
    }

    /* Asistan ƒ∞konlarƒ± */
    .assistant-bar {
      height: var(--assist-h);
      display:flex; align-items:center; gap:15px;
      overflow-x: auto; padding: 0 15px;
      border-bottom: 1px solid rgba(255,255,255,0.05);
    }
    .nav-item {
      flex:0 0 auto; display:flex; flex-direction:column; align-items:center; gap:4px;
      opacity:0.6; transition:0.2s; cursor:pointer;
    }
    .nav-item.active { opacity:1; color:var(--gold); }
    .nav-icon { width:24px; height:24px; fill:currentColor; }
    .nav-label { font-size:10px; font-weight:bold; }

    /* Input Alanƒ± */
    .input-row {
      height: var(--input-h);
      display:flex; align-items:center; gap:10px; padding: 0 15px;
    }
    #msgInput {
      flex:1; height:44px; background:#111; border:1px solid #333; color:#fff;
      border-radius:22px; padding:12px 15px; resize:none;
    }
    .send-btn {
      width:44px; height:44px; border-radius:50%; background:var(--gold); border:none;
      display:flex; align-items:center; justify-content:center; cursor:pointer; font-weight:900;
    }

    /* Footer Linkler */
    .footer-links {
      height: var(--footer-h);
      display:flex; align-items:center; justify-content:center; gap:15px;
      font-size:11px; color:#666; background:#050505;
    }
    .footer-links a { color:#888; text-decoration:none; }

    /* =========================================================
       6. SIDEBAR (HAMBURGER MENU)
       ========================================================= */
    .menu-overlay {
      position:fixed; inset:0; background:rgba(0,0,0,0.8); z-index: 5000;
      opacity:0; pointer-events:none; transition:0.3s;
    }
    .menu-overlay.open { opacity:1; pointer-events:auto; }
    
    .sidebar {
      width:280px; height:100%; background:#111;
      transform:translateX(-100%); transition:0.3s cubic-bezier(0.2, 0.8, 0.2, 1);
      display:flex; flex-direction:column; border-right:1px solid #333;
      padding:20px;
    }
    .menu-overlay.open .sidebar { transform:translateX(0); }

    .sidebar-profile {
      display:flex; align-items:center; gap:12px;
      padding:15px; background:#1a1a1a; border-radius:12px;
      border:1px solid #333; margin-bottom:20px;
    }
    .sidebar-avatar { width:48px; height:48px; border-radius:50%; background:var(--gold); object-fit:cover; }
    .sidebar-info h3 { margin:0; font-size:14px; color:#fff; }
    .sidebar-info p { margin:2px 0 0; font-size:11px; color:#888; }
    .edit-btn { margin-top:5px; font-size:10px; color:var(--pistachio); cursor:pointer; }

    .menu-list a {
      display:block; padding:12px; color:#bbb; text-decoration:none; font-weight:600;
      border-bottom:1px solid #222;
    }
    .menu-list a:hover { color:#fff; padding-left:16px; transition:0.2s; }

    .logout-btn { margin-top:auto; color:#f55; cursor:pointer; padding:10px; font-weight:bold; }

    /* =========================================================
       7. LOGIN SCREEN (OVERLAY)
       ========================================================= */
    .login-view {
      position:fixed; inset:0; z-index:9000; background:#000;
      display:flex; flex-direction:column; align-items:center; justify-content:center;
      padding:20px;
    }
    .login-card {
      width:100%; max-width:360px;
      background: #111; padding:30px 20px; border-radius:20px;
      border:1px solid #333; text-align:center;
    }
    .login-logo { width:60px; height:60px; background:var(--gold); border-radius:50%; margin:0 auto 15px; line-height:60px; font-size:30px; font-weight:bold; color:#000; }
    
    .google-btn-container {
      position: relative; width:100%; height:50px; margin-top:20px;
    }
    /* G√∂r√ºnen Custom Buton */
    .custom-g-btn {
      width:100%; height:100%; border-radius:25px; border:none;
      background: #4285F4; color:#fff; font-weight:bold; font-size:14px;
      display:flex; align-items:center; justify-content:center; gap:10px;
    }
    /* G√∂r√ºnmez Ger√ßek Google Butonu */
    #googleBtnWrapper {
      position: absolute; top:0; left:0; width:100%; height:100%;
      opacity: 0.01; z-index:10; cursor:pointer; overflow:hidden;
    }

    .toast {
      position:fixed; bottom:100px; left:50%; transform:translateX(-50%);
      background:rgba(50,50,50,0.95); color:#fff; padding:10px 20px;
      border-radius:30px; font-size:12px; z-index:9999; opacity:0; pointer-events:none; transition:0.3s;
    }
    .toast.show { opacity:1; bottom:120px; }
  </style>
</head>
<body>

  <div class="toast" id="toast">Bildirim</div>

  <div class="login-view" id="loginView">
    <div class="login-card">
      <div class="login-logo">C</div>
      <h2>Caynana AI</h2>
      <p style="color:#777; font-size:13px;">Yapay Zek√¢nƒ±n Geleneksel Aklƒ±</p>

      <div class="google-btn-container">
        <button class="custom-g-btn">
          <span>G</span> Google ile Devam Et
        </button>
        <div id="googleBtnWrapper"></div>
      </div>
      
      <p style="margin-top:20px; font-size:11px; color:#555;">Giri≈ü yaparak kullanƒ±m ko≈üullarƒ±nƒ± kabul edersiniz.</p>
    </div>
  </div>

  <div class="app-view">
    
    <div class="topbar">
      <button class="hamb-btn" id="hambBtn">‚ò∞</button>
      <div class="brand">Caynana<span>AI</span></div>
      <div class="user-pill">
        <span class="user-name-small" id="topName">Misafir</span>
        <img src="" class="user-avatar-small" id="topAvatar" style="display:none">
      </div>
    </div>

    <div class="chat-area" id="chatArea">
      </div>

    <div class="menu-overlay" id="menuOverlay">
      <div class="sidebar">
        <div class="sidebar-profile">
          <img src="" class="sidebar-avatar" id="sidebarAvatar">
          <div class="sidebar-info">
            <h3 id="sidebarName">Kullanƒ±cƒ±</h3>
            <p id="sidebarEmail">Giri≈ü Yapƒ±lmadƒ±</p>
            <div class="edit-btn" id="editProfileBtn">‚úèÔ∏è Profili D√ºzenle</div>
          </div>
        </div>
        
        <div class="menu-list">
          <a href="#">üí¨ Yeni Sohbet</a>
          <a href="#">üìú Ge√ßmi≈ü</a>
          <a href="#">‚öôÔ∏è Ayarlar</a>
          <a href="#">üí≥ √úyelik (Free)</a>
        </div>

        <div class="logout-btn" id="logoutBtn">√áƒ±kƒ±≈ü Yap</div>
      </div>
    </div>

    <div class="bottom-dock">
      <div class="assistant-bar">
        <div class="nav-item active"><div class="nav-icon">üí¨</div><div class="nav-label">Sohbet</div></div>
        <div class="nav-item"><div class="nav-icon">‚òï</div><div class="nav-label">Fal</div></div>
        <div class="nav-item"><div class="nav-icon">üîÆ</div><div class="nav-label">Tarot</div></div>
        <div class="nav-item"><div class="nav-icon">üåô</div><div class="nav-label">R√ºya</div></div>
        <div class="nav-item"><div class="nav-icon">ü•ó</div><div class="nav-label">Diyet</div></div>
      </div>

      <div class="input-row">
        <textarea id="msgInput" placeholder="Bir ≈üeyler yaz evladƒ±m..."></textarea>
        <button class="send-btn">‚û§</button>
      </div>

      <div class="footer-links">
        <a href="#">Hakkƒ±mƒ±zda</a> ‚Ä¢ <a href="#">Gizlilik</a> ‚Ä¢ <a href="#">ƒ∞leti≈üim</a>
      </div>
    </div>

  </div>

<script>
  /* =========================================================
     JAVASCRIPT LOGIC
     ========================================================= */

  // DOM Elements
  const loginView = document.getElementById('loginView');
  const googleBtnWrapper = document.getElementById('googleBtnWrapper');
  const menuOverlay = document.getElementById('menuOverlay');
  const chatArea = document.getElementById('chatArea');
  
  // User Data Elements
  const topName = document.getElementById('topName');
  const topAvatar = document.getElementById('topAvatar');
  const sidebarName = document.getElementById('sidebarName');
  const sidebarEmail = document.getElementById('sidebarEmail');
  const sidebarAvatar = document.getElementById('sidebarAvatar');

  // --- 1. TOAST MESAJI ---
  function showToast(msg) {
    const t = document.getElementById('toast');
    t.innerText = msg;
    t.classList.add('show');
    setTimeout(() => t.classList.remove('show'), 3000);
  }

  // --- 2. VERƒ∞ Y√ñNETƒ∞Mƒ∞ & RENDER (Eksik olan kƒ±sƒ±m buydu) ---
  function renderUserData() {
    const userRaw = localStorage.getItem("caynana_user_v1");
    if (!userRaw) return;

    const user = JSON.parse(userRaw);
    
    // Topbar g√ºncelle
    topName.textContent = user.fullname || "Misafir";
    if (user.picture) {
      topAvatar.src = user.picture;
      topAvatar.style.display = "block";
    }

    // Sidebar g√ºncelle
    sidebarName.textContent = user.fullname || "ƒ∞simsiz";
    sidebarEmail.textContent = user.email || "";
    if (user.picture) {
      sidebarAvatar.src = user.picture;
    } else {
      sidebarAvatar.style.backgroundColor = "#ffb300"; // Resim yoksa sarƒ± top
    }
  }

  function enterApp() {
    document.body.classList.add('is-logged');
    renderUserData(); // Veriyi ekrana bas!
    
    // Chat bo≈üsa ho≈ügeldin mesajƒ± ekle
    if(chatArea.innerHTML.trim() === "") {
      chatArea.innerHTML = `
        <div class="msg bot">Merhaba evladƒ±m, ho≈ügeldin! Ben Caynana. <br>Sana nasƒ±l yardƒ±m edeyim?</div>
      `;
    }
  }

  // --- 3. GOOGLE Gƒ∞Rƒ∞≈û (OVERLAY FIXED) ---
  function handleCredentialResponse(response) {
    try {
      const base64Url = response.credential.split('.')[1];
      const base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');
      const jsonPayload = decodeURIComponent(atob(base64).split('').map(function(c) {
          return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);
      }).join(''));

      const payload = JSON.parse(jsonPayload);
      
      // Veriyi kaydet
      const user = {
        fullname: payload.name,
        email: payload.email,
        picture: payload.picture
      };
      localStorage.setItem("caynana_user_v1", JSON.stringify(user));

      // Uygulamaya gir
      enterApp();
      showToast("Giri≈ü Ba≈üarƒ±lƒ±!");

    } catch (e) {
      console.error(e);
      showToast("Giri≈ü hatasƒ± olu≈ütu.");
    }
  }

  // Google Butonunu Render Et
  window.onload = function() {
    // Oturum kontrol√º
    if(localStorage.getItem("caynana_user_v1")) {
      enterApp();
    }

    // GSI Ba≈ülat
    const clientID = "BURAYA_CLIENT_ID_YAZMAYI_UNUTMA"; // <--- BURAYI DOLDUR

    if(window.google) {
      google.accounts.id.initialize({
        client_id: clientID,
        callback: handleCredentialResponse,
        auto_select: false
      });

      // Overlay Buton Render (B√ºy√ºk boyutta)
      google.accounts.id.renderButton(
        document.getElementById("googleBtnWrapper"),
        { 
          theme: "outline", 
          size: "large", 
          width: 350, // Wrapper geni≈üliƒüi kadar
          height: 50,
          text: "signin_with" 
        }
      );
    }
  };

  // --- 4. UI OLAYLARI ---
  
  // Hamburger Men√º A√ß/Kapa
  document.getElementById('hambBtn').addEventListener('click', () => {
    menuOverlay.classList.add('open');
  });
  
  menuOverlay.addEventListener('click', (e) => {
    if(e.target === menuOverlay) menuOverlay.classList.remove('open');
  });

  // √áƒ±kƒ±≈ü Yap
  document.getElementById('logoutBtn').addEventListener('click', () => {
    if(confirm("Gidiyor musun evladƒ±m?")) {
      localStorage.removeItem("caynana_user_v1");
      location.reload();
    }
  });

  // Profil D√ºzenle (≈ûimdilik bo≈ü ama tepki veriyor)
  document.getElementById('editProfileBtn').addEventListener('click', () => {
    showToast("Profil d√ºzenleme yakƒ±nda a√ßƒ±lacak evladƒ±m.");
  });

</script>
</body>
</html>
