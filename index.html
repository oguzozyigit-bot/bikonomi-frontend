<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, interactive-widget=resizes-content" />
<title>Caynana AI v2.7 Final</title>
<link rel="icon" href="data:,">
<script src="https://accounts.google.com/gsi/client" async defer></script>

<style>
Â  /* --- TEMEL CSS (DeÄŸiÅŸmedi) --- */
Â  :root { --bg-outer: #000; --bg: #0e0e0e; --text: #ececec; --gold: #ffb300; --pistachio: #bef264; --glass: rgba(20, 20, 20, 0.98); --border: rgba(255, 255, 255, 0.12); --lip-color: #d84315; --card-bg: #1a1a1a; }
Â  * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
Â  body, html { margin: 0; padding: 0; width: 100%; height: 100dvh; background: var(--bg-outer); font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; color: var(--text); overflow: hidden; display: flex; align-items: center; justify-content: center; }
Â Â 
Â  .mobile-frame { width: 100%; height: 100%; max-width: 480px; background: var(--bg); position: relative; display: flex; flex-direction: column; box-shadow: 0 0 50px rgba(255, 255, 255, 0.05); overflow: hidden; }
Â  @media (min-width: 500px) { .mobile-frame { height: 95dvh; border-radius: 24px; border: 1px solid #333; } }

Â  /* --- HEADER & LOGO --- */
Â  .topbar { flex: 0 0 75px; background: var(--glass); border-bottom: 1px solid var(--border); display: flex; align-items: center; justify-content: space-between; padding: 0 16px; z-index: 3000; }
Â  .left-controls { display: flex; gap: 15px; align-items: center; }
Â  .hamb-btn { background: none; border: none; cursor: pointer; color: #aaa; font-size: 24px; padding: 0; }
Â Â 
Â  .brand-wrapper { display: flex; flex-direction: column; align-items: center; margin-right: 40px; flex: 1; transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
Â  .logo-area { display: flex; align-items: center; gap: 8px; }
Â  .brand-name { font-weight: 700; font-size: 16px; color: #fff; }
Â  .slogan { font-size: 11px; color: #888; margin-top: 2px; font-weight: 500; letter-spacing: 0.5px; }Â 
Â Â 
Â  .seesaw-svg { width: 36px; height: 18px; overflow: visible; }
Â  .seesaw-bar { transform-origin: 20px 8px; transition: transform 0.4s; }
Â Â 
Â  /* ANÄ°MASYONLAR */
Â  .brand-wrapper.talking .seesaw-bar { animation: talkWiggle 0.4s infinite alternate ease-in-out; }
Â  @keyframes talkWiggle { from { transform: rotate(-12deg); } to { transform: rotate(12deg); } }
Â Â 
Â  .brand-wrapper.thinking #orangeBall { animation: breathAnim 0.8s infinite alternate ease-in-out; transform-box: fill-box; transform-origin: center; }
Â  @keyframes breathAnim { from { transform: scale(1); filter: brightness(1); } to { transform: scale(1.5); filter: brightness(1.3); box-shadow: 0 0 10px var(--gold); } }
Â Â 
Â  /* --- BÄ°LDÄ°RÄ°M --- */
Â  .notif-btn { background: none; border: none; position: relative; cursor: pointer; padding: 5px; display: flex; align-items: center; }
Â  .notif-btn svg { width: 26px; height: 26px; stroke: #aaa; fill: none; stroke-width: 2; transition: 0.2s; }
Â  .notif-btn:active svg { stroke: var(--pistachio); }
Â  .badge { position: absolute; top: 4px; right: 4px; width: 8px; height: 8px; background: #ff5252; border-radius: 50%; display: none; border: 1px solid #000; }

Â  .notification-dropdown { position: absolute; top: 70px; right: 10px; width: 300px; background: #1c1c1c; border: 1px solid #333; border-radius: 12px; box-shadow: 0 10px 40px rgba(0,0,0,0.5); z-index: 4000; display: none; flex-direction: column; overflow: hidden; animation: slideDown 0.2s ease; }
Â  .notification-dropdown.show { display: flex; }
Â  @keyframes slideDown { from {opacity:0; transform:translateY(-10px);} to {opacity:1; transform:translateY(0);} }

Â  .notif-header { padding: 12px; border-bottom: 1px solid #333; font-size: 13px; font-weight: bold; color: #fff; background: #222; }
Â  .notif-list { max-height: 300px; overflow-y: auto; }
Â  .notif-item { padding: 12px; border-bottom: 1px solid #2a2a2a; display: flex; gap: 10px; align-items: start; }
Â  .notif-item:last-child { border-bottom: none; }
Â  .notif-icon { font-size: 18px; }
Â  .notif-content { flex: 1; }
Â  .notif-title { font-size: 13px; color: #fff; font-weight: 600; margin-bottom: 2px; }
Â  .notif-desc { font-size: 11px; color: #aaa; line-height: 1.3; }
Â  .notif-time { font-size: 10px; color: #666; margin-top: 4px; }

Â  /* --- CHAT --- */
Â  .chat-area { flex: 1; overflow-y: auto; padding: 20px 16px; display: flex; flex-direction: column; gap: 16px; scroll-behavior: smooth; scrollbar-width: none; }
Â  .chat-area::-webkit-scrollbar { display: none; }
Â  .bubble { max-width: 85%; padding: 12px 14px; border-radius: 18px; font-size: 15px; line-height: 1.4; position: relative; animation: pop 0.2s ease; word-wrap: break-word; flex-shrink: 0; height: auto; }
Â  .bubble.bot { align-self: flex-start; background: #1c1c1c; border-left: 3px solid var(--gold); color: #ddd; border-top-left-radius: 4px; min-height: 40px;}
Â  .bubble.user { align-self: flex-end; background: #222; border-right: 3px solid var(--pistachio); color: #fff; border-top-right-radius: 4px; text-align: right; }

Â  /* --- DOCK & FOOTER --- */
Â  .input-dock { flex: 0 0 auto; background: var(--glass); padding: 5px 16px 15px 16px; z-index: 3000; border-top: 1px solid var(--border); display: flex; flex-direction: column; gap: 8px; }
Â  .track-trigger-row { display: flex; justify-content: center; width: 100%; transition: 0.3s; height: 36px; overflow: hidden; }
Â  .mobile-frame.tracking-active .track-trigger-row { height: 0; margin: 0; opacity: 0; pointer-events: none; }
Â  .main-track-btn { background: rgba(255, 179, 0, 0.1); border: 1px solid var(--gold); color: var(--gold); padding: 8px 24px; border-radius: 24px; cursor: pointer; font-size: 13px; font-weight: 600; box-shadow: 0 0 15px rgba(255, 179, 0, 0.1); animation: pulseBtn 2s infinite; display: flex; align-items: center; gap: 8px; }
Â Â 
Â  .dock-inner { display: flex; align-items: flex-end; gap: 8px; background: #1a1a1a; border: 1px solid #333; border-radius: 24px; padding: 6px; }
Â  .icon-btn { width: 42px; height: 42px; border-radius: 50%; border: none; background: transparent; display: flex; align-items: center; justify-content: center; cursor: pointer; flex-shrink: 0; transition: 0.2s; }
Â  .icon-btn svg { width: 22px; height: 22px; stroke: #aaa; stroke-width: 2; fill: none; transition: 0.2s; }
Â  .icon-btn:hover svg, .icon-btn.active svg { stroke: var(--gold); }
Â  .icon-btn.active { background: rgba(255,179,0,0.15); }
Â  .send-btn { width: 42px; height: 42px; border-radius: 50%; background: var(--pistachio); color: #000; border: none; display: flex; align-items: center; justify-content: center; cursor: pointer; transition: 0.2s; box-shadow: 0 4px 10px rgba(190, 242, 100, 0.3); }
Â  .send-btn svg { stroke: #000; fill:none; width:22px; height:22px; }
Â  textarea { flex: 1; background: transparent; border: none; outline: none; color: #fff; font-size: 16px; resize: none; padding: 10px; max-height: 100px; min-height: 24px; font-family: inherit; scrollbar-width: none; }

Â  /* FOOTER */
Â  .footer-container { text-align: center; width: 100%; padding: 15px 0; background: #000; border-top: 1px solid #222; margin-top: auto; }
Â  .footer-container span { font-size: 12px; color: #aaa; font-weight: 600; letter-spacing: 0.5px; opacity: 0.9; }
Â  .footer-ver { font-size: 10px; color: #666; font-family: monospace; margin-top: 4px; }

Â  /* --- LOGIN & MENU --- */
Â  .full-overlay { position: absolute; inset: 0; background: #000; z-index: 6000; display: flex; flex-direction: column; align-items: center; justify-content: center; opacity: 0; pointer-events: none; transition: 0.4s ease; padding: 20px; overflow-y: auto; }
Â  .full-overlay.active { opacity: 1; pointer-events: auto; }
Â  .login-card { width: 100%; max-width: 320px; text-align: center; display: flex; flex-direction: column; gap: 15px; margin: auto; }
Â  .login-logo { font-size: 28px; font-weight: 800; color: #fff; margin-bottom: 5px; }
Â  .login-logo span { color: var(--gold); }
Â Â 
Â  .auth-btn { width: 100%; padding: 12px; border-radius: 12px; border: none; font-size: 14px; font-weight: 600; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 10px; transition: 0.2s; opacity: 0.5; pointer-events: none; filter: grayscale(1); margin-bottom: 8px; }
Â  .auth-btn.enabled { opacity: 1; pointer-events: auto; filter: grayscale(0); }
Â  .btn-google { background: #fff; color: #333; border: 1px solid #ddd; }Â 
Â  .btn-apple { background: #000; color: #fff; border: 1px solid #333; }
Â  .auth-icon { width: 20px; height: 20px; }

Â  .agreement-box { display: flex; align-items: center; gap: 10px; font-size: 12px; color: #888; justify-content: center; margin-top: 10px; text-align: left; }
Â  .agreement-box input { width: 18px; height: 18px; accent-color: var(--gold); cursor: pointer; }
Â Â 
Â  .login-footer-links { margin-top: 30px; display: flex; flex-wrap: wrap; justify-content: center; gap: 12px; border-top: 1px solid #222; padding-top: 20px; }
Â  .login-footer-links a { color: #666; font-size: 11px; text-decoration: none; transition: 0.2s; }
Â  .login-footer-links a:hover { color: var(--gold); }
Â Â 
Â  /* MENU */
Â  .menu-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.7); z-index: 5000; opacity: 0; pointer-events: none; transition: 0.3s; backdrop-filter: blur(5px); display:flex; justify-content: flex-start;}
Â  .menu-overlay.open { opacity: 1; pointer-events: auto; }
Â  .menu-sidebar { width: 270px; height: 100%; background: #161616; padding: 20px 20px 20px; transform: translateX(-100%); transition: 0.3s cubic-bezier(0.4, 0, 0.2, 1); display: flex; flex-direction: column; border-right: 1px solid #333; box-shadow: 5px 0 30px rgba(0,0,0,0.5); }
Â  .menu-overlay.open .menu-sidebar { transform: translateX(0); }
Â Â 
Â  .sidebar-header { padding: 30px 0 20px 0; border-bottom: 1px solid #222; margin-bottom: 10px; }
Â  .new-chat-btn { width: 100%; background: #333; color: var(--pistachio); border: 1px solid #444; padding: 12px; border-radius: 10px; font-weight: bold; cursor: pointer; text-align: center; margin-bottom: 15px; display:flex; justify-content:center; align-items:center; gap:8px; }
Â Â 
Â  .history-list { flex: 1; overflow-y: auto; display: flex; flex-direction: column; gap: 5px; margin-bottom: 20px; min-height: 100px; }
Â  .history-item { color: #ccc; padding: 12px 10px; border-radius: 8px; font-size: 14px; cursor: pointer; display: flex; justify-content: space-between; align-items: center; transition: 0.2s; }
Â  .history-item:hover { background: #222; color: #fff; }
Â  .history-item:hover .delete-chat-btn { display: block; }
Â  .history-text { overflow: hidden; white-space: nowrap; text-overflow: ellipsis; max-width: 190px; }
Â  .delete-chat-btn { display: none; background: none; border: none; color: #ff5252; cursor: pointer; font-size: 16px; padding: 0 5px; }

Â  .menu-static-links { border-top: 1px solid #2a2a2a; padding-top: 10px; }
Â  .menu-item { color: #888; text-decoration: none; padding: 10px 0; display: block; font-size: 13px; transition: 0.2s; cursor:pointer; }
Â  .menu-item:hover { color: var(--gold); }

Â  .menu-footer-actions { margin-top: auto; padding-top: 10px; border-top: 1px solid #333; }
Â  .menu-version { text-align: center; font-size: 10px; color: #555; margin-top: 20px; }
Â Â 
Â  #camVideo { display: none; }

Â  /* GÃ–ZLER */
Â  .face-container { flex: 0 0 0px; background: linear-gradient(to bottom, var(--bg), transparent); overflow: hidden; transition: flex-basis 0.5s; display: flex; flex-direction: column; align-items: center; justify-content: center; position: relative; z-index: 2500; }
Â  .mobile-frame.tracking-active .face-container { flex-basis: 180px; }Â 
Â  .face-panel-inner { width: 100%; height: 100%; display: flex; flex-direction: column; align-items: center; justify-content: center; opacity: 0; transform: translateY(-30px); transition: 0.4s; }
Â  .mobile-frame.tracking-active .face-panel-inner { opacity: 1; transform: translateY(0); }
Â  .eyes-row { display: flex; gap: 24px; margin-bottom: 10px; }
Â  .eye { width: 90px; height: 65px; position: relative; --lidTop:0%; --lidBot:0%; --gx:0px; --gy:0px; transition: 0.2s cubic-bezier(0.25, 0.46, 0.45, 0.94); }
Â  .sclera { width: 100%; height: 100%; background: #e0e0e0; border-radius: 50%; overflow: hidden; position: relative; border: 2px solid #1a1a1a; box-shadow: inset 0 0 10px rgba(0,0,0,0.8); }
Â  .iris { width: 32px; height: 32px; background: radial-gradient(circle, #5d4037 0%, #281a16 100%); border-radius: 50%; position: absolute; top: 50%; left: 50%; transform: translate(calc(-50% + var(--gx)), calc(-50% + var(--gy))); border: 1px solid rgba(255,255,255,0.25); transition: transform 0.1s linear; }
Â  .pupil { width: 10px; height: 10px; background: #000; border-radius: 50%; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); }
Â  .reflection { position: absolute; top: 6px; right: 6px; width: 4px; height: 4px; background: #fff; border-radius: 50%; opacity: 0.9; }
Â  .lid-top, .lid-bot { position: absolute; left: 0; width: 100%; background: var(--bg); z-index: 10; transition: height 0.3s ease-in-out; }
Â  .lid-top { top: 0; height: var(--lidTop); border-bottom: 2px solid #222; }
Â  .lid-bot { bottom: 0; height: var(--lidBot); border-top: 2px solid #222; }
Â  .mobile-frame.sleeping .eyes-row { animation: sleepBreath 4s infinite ease-in-out; opacity: 0.6; }
Â  @keyframes sleepBreath { 0%, 100% { transform: scale(1); } 50% { transform: scale(0.95) translateY(2px); } }
Â  .mouth-wrapper { width: 60px; height: 26px; display: flex; justify-content: center; align-items: center; position: relative; margin-top: 8px; }
Â  .mouth { width: 40px; height: 10px; border-top: 3px solid var(--lip-color); border-radius: 50% 50% 0 0; position: absolute; top: 8px; transition: 0.15s; opacity: 0.9; }
Â  .close-track-btn { margin-top: 10px; background: rgba(198, 40, 40, 0.15); color: #ef9a9a; border: 1px solid rgba(198, 40, 40, 0.4); padding: 5px 14px; border-radius: 20px; font-size: 11px; cursor: pointer; }
</style>
</head>
<body>

<div class="mobile-frame" id="mobileFrame">

Â  <div class="full-overlay active" id="loginOverlay">
Â  Â  <div class="login-card">
Â  Â  Â  <div style="display:flex; justify-content:center; margin-bottom:10px;">
Â  Â  Â  Â  <svg class="seesaw-svg" viewBox="0 0 40 20" style="width:60px; height:30px;">
Â  Â  Â  Â  Â  <polygon points="17,14 23,14 20,8" fill="none" stroke="#666" stroke-width="1.5" />
Â  Â  Â  Â  Â  <g class="seesaw-bar">
Â  Â  Â  Â  Â  Â  <line x1="0" y1="8" x2="40" y2="8" stroke="#ccc" stroke-width="2" stroke-linecap="round" />
Â  Â  Â  Â  Â  Â  <circle cx="3" cy="5" r="3" fill="#bef264" />
Â  Â  Â  Â  Â  Â  <circle cx="37" cy="5" r="3" fill="#ffb300" id="orangeBall" />
Â  Â  Â  Â  Â  </g>
Â  Â  Â  Â  </svg>
Â  Â  Â  </div>

Â  Â  Â  <div class="login-logo">Caynana<span>.AI</span></div>
Â  Â  Â  <div style="font-size:13px; color:#888;">Yapay ZekÃ¢nÄ±n Geleneksel AklÄ±</div>
Â  Â  Â  <br>

Â  Â  Â  <div style="border-bottom:1px solid #333; padding-bottom:15px; margin-bottom:15px;">
Â  Â  Â  Â  <div style="font-size:11px; color:#666; margin-bottom:8px; text-transform:uppercase; letter-spacing:1px;">Devam Et</div>

Â  Â  Â  Â  <button class="auth-btn btn-google enabled" id="googleLoginBtn">
Â  Â  Â  Â  Â  <svg class="auth-icon" viewBox="0 0 24 24"><path d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z" fill="#4285F4"/><path d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" fill="#34A853"/><path d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" fill="#FBBC05"/><path d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" fill="#EA4335"/></svg>
Â  Â  Â  Â  Â  Google ile Devam Et
Â  Â  Â  Â  </button>

Â  Â  Â  Â  <button class="auth-btn btn-apple enabled" id="appleLoginBtn">
Â  Â  Â  Â  Â  <svg class="auth-icon" viewBox="0 0 24 24" fill="#fff"><path d="M17.05 20.28c-.98.95-2.05.88-3.08.4-1.09-.5-2.08-.48-3.24.02-1.44.62-2.2.44-3.06-.4C2.79 15.25 3.51 7.59 9.05 7.31c1.35.07 2.29.74 3.08.74s2.57-.91 4.35-.68c.75.04 2.86.32 3.9 1.83-3.23 1.6-2.67 6.38 1.02 7.94-.75 1.49-1.81 2.97-2.89 4.01l-.22.25-.24-.12zM12.03 7.25c-.15-2.23 1.66-4.07 3.74-4.25.29 2.58-2.54 4.33-3.74 4.25z"/></svg>
Â  Â  Â  Â  Â  Apple ile Devam Et
Â  Â  Â  Â  </button>
Â  Â  Â  </div>

Â  Â  Â  <div class="login-footer-links">
Â  Â  Â  Â  <a href="pages/hakkimizda.html">HakkÄ±mÄ±zda</a>
Â  Â  Â  Â  <a href="pages/sss.html">SSS</a>
Â  Â  Â  Â  <a href="pages/gizlilik.html">Gizlilik</a>
Â  Â  Â  Â  <a href="pages/sozlesme.html">KullanÄ±m</a>
Â  Â  Â  Â  <a href="pages/iletisim.html">Ä°letiÅŸim</a>
Â  Â  Â  </div>

Â  Â  Â  <div style="margin-top:20px; border-top:1px solid #222; padding-top:15px;">
Â  Â  Â  Â  <div style="font-weight:600; color:#aaa; font-size:12px;">@CaynanaAI By Ozyigits</div>
Â  Â  Â  </div>
Â  Â  </div>
Â  </div>

Â  <div class="full-overlay" id="termsOverlay" style="z-index:6500; background:#000;">
Â  Â  <div class="login-card" style="max-width:420px;">
Â  Â  Â  <div class="login-logo">SÃ¶zleÅŸme<span>.Onay</span></div>
Â  Â  Â  <div style="font-size:12px; color:#888; line-height:1.5;">
Â  Â  Â  Â  Devam etmek iÃ§in sÃ¶zleÅŸmeyi onaylaman gerekiyor evladÄ±m.
Â  Â  Â  </div>

Â  Â  Â  <div style="border:1px solid #222; border-radius:12px; overflow:hidden; height:320px; background:#111;">
Â  Â  Â  Â  <iframe src="pages/sozlesme.html" style="width:100%; height:100%; border:0;"></iframe>
Â  Â  Â  </div>

Â  Â  Â  <div class="agreement-box" style="justify-content:flex-start; gap:10px;">
Â  Â  Â  Â  <input type="checkbox" id="termsCheck">
Â  Â  Â  Â  <label for="termsCheck" style="color:#aaa;">Okudum, onaylÄ±yorum.</label>
Â  Â  Â  </div>

Â  Â  Â  <button class="auth-btn btn-google enabled" style="filter:none; opacity:1;" id="termsAcceptBtn">
Â  Â  Â  Â  âœ… Onayla ve Devam Et
Â  Â  Â  </button>
Â  Â  </div>
Â  </div>

Â  <div id="menuMount">
Â  Â  <div class="menu-overlay" id="menuOverlay">
Â  Â  Â  <div class="menu-sidebar">
Â  Â  Â  Â  <div class="sidebar-header">
Â  Â  Â  Â  Â  <button class="new-chat-btn" id="newChatBtn"><span>+</span> Yeni Sohbet BaÅŸlat</button>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div style="font-size:11px; color:#666; padding-left:10px; margin-bottom:5px;">SON SOHBETLER</div>
Â  Â  Â  Â  <div class="history-list" id="historyList"></div>
Â  Â  Â  Â  <div class="menu-static-links">
Â  Â  Â  Â  Â  <a class="menu-item" onclick="window.openFal(); window.toggleMenu();">â˜• Kahve FalÄ±</a>
Â  Â  Â  Â  Â  <a class="menu-item" href="pages/profil.html">ğŸ‘¤ Profil AyarlarÄ±</a>
Â  Â  Â  Â  Â  <a class="menu-item" href="pages/hakkimizda.html">â„¹ï¸ HakkÄ±mÄ±zda</a>
Â  Â  Â  Â  Â  <a class="menu-item" href="pages/sss.html">â“ SSS</a>
Â  Â  Â  Â  Â  <a class="menu-item" href="pages/iletisim.html">âœ‰ï¸ Ä°letiÅŸim</a>
Â  Â  Â  Â  Â  <a class="menu-item" href="pages/gizlilik.html">ğŸ”’ Gizlilik</a>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div class="menu-footer-actions">
Â  Â  Â  Â  Â  <a class="menu-item" id="logoutBtn" style="color:#ff5252">ğŸ›¡ï¸ GÃ¼venli Ã‡Ä±kÄ±ÅŸ</a>
Â  Â  Â  Â  Â  <div class="menu-version">@CaynanaAI v2.7</div>
Â  Â  Â  Â  </div>
Â  Â  Â  </div>
Â  Â  </div>
Â  </div>

Â  <div class="topbar">
Â  Â  <div class="left-controls"><button class="hamb-btn" id="hambBtn">â˜°</button></div>
Â  Â  <div class="brand-wrapper" id="brandWrapper">
Â  Â  Â  <div class="logo-area">
Â  Â  Â  Â  <svg class="seesaw-svg" viewBox="0 0 40 20">
Â  Â  Â  Â  Â  <polygon points="17,14 23,14 20,8" fill="none" stroke="#666" stroke-width="1.5" />
Â  Â  Â  Â  Â  <g class="seesaw-bar" id="seesawBar">
Â  Â  Â  Â  Â  Â  Â <line x1="0" y1="8" x2="40" y2="8" stroke="#ccc" stroke-width="2" stroke-linecap="round" />
Â  Â  Â  Â  Â  Â  Â <circle cx="3" cy="5" r="3" fill="#bef264" />
Â  Â  Â  Â  Â  Â  Â <circle cx="37" cy="5" r="3" fill="#ffb300" id="orangeBall" />
Â  Â  Â  Â  Â  </g>
Â  Â  Â  Â  </svg>
Â  Â  Â  Â  <div class="brand-name">Caynana AI</div>
Â  Â  Â  </div>
Â  Â  Â  <div class="slogan">Yapay ZekÃ¢nÄ±n Geleneksel AklÄ±</div>
Â  Â  </div>

Â  Â  <div id="notifMount">
Â  Â  Â  <button class="notif-btn" id="notifBtn">
Â  Â  Â  Â  <svg viewBox="0 0 24 24"><path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path><path d="M13.73 21a2 2 0 0 1-3.46 0"></path></svg>
Â  Â  Â  Â  <div class="badge" id="notifBadge"></div>
Â  Â  Â  </button>

Â  Â  Â  <div class="notification-dropdown" id="notifDropdown">
Â  Â  Â  Â  <div class="notif-header">Bildirimler</div>
Â  Â  Â  Â  <div class="notif-list" id="notifList">
Â  Â  Â  Â  Â  <div class="notif-item">
Â  Â  Â  Â  Â  Â  <div class="notif-icon">ğŸ§¿</div>
Â  Â  Â  Â  Â  Â  <div class="notif-content">
Â  Â  Â  Â  Â  Â  Â  <div class="notif-title">HazÄ±rÄ±m</div>
Â  Â  Â  Â  Â  Â  Â  <div class="notif-desc">EvladÄ±m, hatÄ±rlatmalarÄ±nÄ± bekliyorum.</div>
Â  Â  Â  Â  Â  Â  Â  <div class="notif-time">â€”</div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  Â  </div>
Â  Â  </div>
Â  </div>

Â  <div class="face-container" id="faceContainer">
Â  Â  <div class="face-panel-inner" id="faceInner">
Â  Â  Â  <div class="eyes-row">
Â  Â  Â  Â  <div class="eye" id="eyeL">
Â  Â  Â  Â  Â  <div class="sclera"><div class="iris"><div class="pupil"></div><div class="reflection"></div></div></div>
Â  Â  Â  Â  Â  <div class="lid-top"></div><div class="lid-bot"></div>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div class="eye" id="eyeR">
Â  Â  Â  Â  Â  <div class="sclera"><div class="iris"><div class="pupil"></div><div class="reflection"></div></div></div>
Â  Â  Â  Â  Â  <div class="lid-top"></div><div class="lid-bot"></div>
Â  Â  Â  Â  </div>
Â  Â  Â  </div>
Â  Â  Â  <div class="mouth-wrapper"><div class="mouth"></div></div>
Â  Â  Â  <button class="close-track-btn" id="closeTrackBtn">Takibi Kapat</button>
Â  Â  </div>
Â  </div>

Â  <div class="chat-area" id="chat"></div>

Â  <div class="input-dock">
Â  Â  <div class="track-trigger-row"><button class="main-track-btn" id="openTrackBtn">ğŸ‘ï¸ TAKÄ°P ET</button></div>
Â  Â  <div class="dock-inner">
Â  Â  Â  <button class="icon-btn" id="camBtn"><svg viewBox="0 0 24 24"><path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"></path><circle cx="12" cy="13" r="4"></circle></svg></button>
Â  Â  Â  <textarea id="msgInput" rows="1" placeholder="Ne lazÄ±m evladÄ±m?"></textarea>
Â  Â  Â  <button class="icon-btn" id="micBtn"><svg viewBox="0 0 24 24"><path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"></path><path d="M19 10v2a7 7 0 0 1-14 0v-2"></path><line x1="12" y1="19" x2="12" y2="23"></line><line x1="8" y1="23" x2="16" y2="23"></line></svg></button>
Â  Â  Â  <button class="send-btn" id="sendBtn"><svg viewBox="0 0 24 24"><path d="M22 2L11 13"></path><path d="M22 2L15 22L11 13L2 9L22 2Z"></path></svg></button>
Â  Â  </div>
Â  </div>

Â  <div class="footer-container">
Â  Â  <span>@CaynanaAI By Ozyigits</span>
Â  Â  <div class="footer-ver">2026 - v2.7</div>
Â  </div>
</div>

<div class="full-overlay" id="falOverlay" style="background:#111; z-index:7000;">
Â  <button onclick="window.closeFal()" style="position:absolute; top:20px; right:20px; background:none; border:none; font-size:30px; color:#fff;">&times;</button>
Â  <div style="text-align:center; margin-top:60px;">
Â  Â  <svg class="seesaw-svg" viewBox="0 0 40 20" style="width:60px;">
Â  Â  Â  <g class="seesaw-bar"><line x1="0" y1="8" x2="40" y2="8" stroke="#ccc" stroke-width="2"/><circle cx="20" cy="5" r="5" fill="#6d4c41"/></g>
Â  Â  </svg>
Â  Â  <h2 style="color:#d9f99d; margin:10px 0;">Kaynana Fal</h2>
Â  Â  <p style="color:#888; font-size:12px; padding:0 20px;">
Â  Â  Â  GÃ¼nde sadece 1 kez bakÄ±lÄ±r evladÄ±m. Umudunu fala baÄŸlama, falsÄ±z kalma.
Â  Â  </p>
Â  </div>

Â  <div id="falStep1" style="flex:1; display:flex; flex-direction:column; align-items:center; justify-content:center; gap:20px;">
Â  Â  <div id="falStatus" style="color:#fff; font-size:16px; text-align:center; padding:20px;">Hadi fincanÄ± Ã§ek bakalÄ±m...</div>
Â  Â  <label for="falInput" class="main-track-btn" style="padding:20px; border-radius:50%; width:80px; height:80px; justify-content:center;">
Â  Â  Â  <svg viewBox="0 0 24 24" width="40" height="40" stroke="#ffb300" fill="none" stroke-width="2"><path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"/><circle cx="12" cy="13" r="4"/></svg>
Â  Â  </label>
Â  Â  <input type="file" id="falInput" accept="image/*" capture="environment" style="display:none;" onchange="window.handleFalFile(this)">
Â  </div>

Â  <div id="falStep2" style="flex:1; display:none; flex-direction:column; align-items:center; justify-content:center;">
Â  Â  <div class="brand-wrapper thinking" style="transform:scale(2); margin-bottom:30px;">
Â  Â  Â  <svg class="seesaw-svg" viewBox="0 0 40 20"><g class="seesaw-bar"><circle cx="37" cy="5" r="3" fill="#ffb300" id="orangeBall"/></g></svg>
Â  Â  </div>
Â  Â  <div id="loadingText" style="color:#d9f99d; font-size:18px; text-align:center; padding:20px;">Vay vay vay...</div>
Â  </div>

Â  <div id="falResult" style="flex:1; display:none; flex-direction:column; padding:20px; overflow-y:auto;">
Â  Â  <div id="falText" style="background:#222; padding:20px; border-radius:12px; color:#ececec; line-height:1.6; border:1px solid #333;"></div>
Â  Â  <button onclick="window.closeFal()" class="auth-btn btn-google enabled" style="margin-top:20px; filter:none;">TamamdÄ±r Anne</button>
Â  </div>
</div>

<video id="camVideo" autoplay playsinline muted></video>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@mediapipe/face_mesh/face_mesh.js"></script>

<script type="module">
Â  // --- IMPORTLAR ---
Â  import { initPartials } from '/js/partials.js';
Â  import { initNotif } from '/js/notif.js';
Â  import { initAuth, handleLogin, logout, acceptTerms } from '/js/auth.js';
Â  import { addUserBubble } from '/js/chat.js';
Â  import { BASE_DOMAIN, STORAGE_KEY } from '/js/config.js';
Â  import { openFalPanel, closeFalPanel, handleFalPhoto } from '/js/fal.js';

Â  // --- GLOBAL DEÄÄ°ÅKENLER & SEÃ‡Ä°CÄ°LER ---
Â  let chatHistory = [];
Â  const $ = (id) => document.getElementById(id);

Â  // --- GLOBAL'E ATAMALAR (HTML onclick Ã§alÄ±ÅŸsÄ±n diye) ---
Â  window.handleLogin = handleLogin;
Â  window.logout = logout;
Â  window.acceptTermsAndEnter = acceptTermsAndEnter;
Â  window.openFal = openFalPanel;
Â  window.closeFal = closeFalPanel;
Â  window.handleFalFile = handleFalPhoto;
Â  window.toggleMenu = function() {
Â  Â  const el = $('menuOverlay');
Â  Â  if(el) el.classList.toggle('open');
Â  };
Â  window.toggleNotif = function() {
Â  Â  const el = $('notifDropdown');
Â  Â  if(el) el.classList.toggle('show');
Â  };

Â  // --- YENÄ° EKLENEN KRÄ°TÄ°K FONKSÄ°YONLAR ---
Â Â 
Â  // 1. ÅartlarÄ± Kabul Et ve Gir (GÃ¼venli Versiyon)
Â  async function acceptTermsAndEnter(){
Â  Â  const cb = $('termsCheck');
Â  Â  if(!cb || !cb.checked){ alert("Onay kutusunu iÅŸaretle evladÄ±m."); return; }
Â  Â  const ok = await acceptTerms();
Â  Â  if(ok) window.enterApp();
Â  Â  else alert("Onay kaydedilemedi evladÄ±m.");
Â  };

Â  // 2. Uygulamaya GiriÅŸ (UI GÃ¼ncelleme)
Â  window.enterApp = function() {
Â  Â  $('loginOverlay')?.classList.remove('active');
Â  Â  $('termsOverlay')?.classList.remove('active');
Â  Â Â 
Â  Â  const user = JSON.parse(localStorage.getItem(STORAGE_KEY) || "{}");
Â  Â  // Ä°sim KontrolÃ¼ (Hata Ã¶nleyici)
Â  Â  const name = user.fullname || user.name || user.email || "EvladÄ±m";
Â  Â Â 
Â  Â  setTimeout(() => {
Â  Â  Â  window.typeWriter(`HoÅŸ geldin ${name}. Ben Caynana.`);
Â  Â  }, 500);
Â  Â Â 
Â  Â  window.refreshNotifications?.();
Â  };

Â  // 3. Mesaj GÃ¶nderme (Safe + Text/Message Uyumlu)
Â  window.sendMessage = async function() {
Â  Â  const inputEl = $('msgInput');
Â  Â  if (!inputEl) { console.error("Input bulunamadÄ±"); return; }
Â  Â Â 
Â  Â  const txt = inputEl.value.trim();
Â  Â  if(!txt) return;

Â  Â  // UI
Â  Â  addUserBubble(txt);
Â  Â  inputEl.value = '';
Â  Â  inputEl.blur();

Â  Â  // History
Â  Â  chatHistory.push({ role: "user", content: txt });
Â  Â  if(chatHistory.length > 10) chatHistory = chatHistory.slice(-10);

Â  Â  const brand = $('brandWrapper');
Â  Â  if(brand) brand.classList.add('thinking');

Â  Â  try {
Â  Â  Â  const user = JSON.parse(localStorage.getItem(STORAGE_KEY) || "{}");
Â  Â  Â Â 
Â  Â  Â  const res = await fetch(`${BASE_DOMAIN}/api/chat`, {
Â  Â  Â  Â  method: "POST",
Â  Â  Â  Â  headers: { "Content-Type": "application/json" },
Â  Â  Â  Â  body: JSON.stringify({
Â  Â  Â  Â  Â  text: txt,Â  // Backend v14.5 ile uyumlu
Â  Â  Â  Â  Â  user_id: user.id || "guest",
Â  Â  Â  Â  Â  history: chatHistory
Â  Â  Â  Â  })
Â  Â  Â  });

Â  Â  Â  const data = await res.json();
Â  Â  Â  if(brand) brand.classList.remove('thinking');

Â  Â  Â  if(data && data.text) {
Â  Â  Â  Â  window.typeWriter(data.text);
Â  Â  Â  Â  chatHistory.push({ role: "assistant", content: data.text });
Â  Â  Â  Â Â 
Â  Â  Â  Â  if(data.audio) {
Â  Â  Â  Â  Â  Â const audio = new Audio("data:audio/mp3;base64," + data.audio);
Â  Â  Â  Â  Â  Â audio.play().catch(e => console.log("Ses hatasÄ±:", e));
Â  Â  Â  Â  }
Â  Â  Â  }
Â  Â  } catch(e) {
Â  Â  Â  console.error("Chat Error:", e);
Â  Â  Â  if(brand) brand.classList.remove('thinking');
Â  Â  Â  window.typeWriter("EvladÄ±m tansiyonum dÃ¼ÅŸtÃ¼, internetine bir bakÄ±ver.");
Â  Â  }
Â  };

Â  // 4. YazÄ± Efekti
Â  window.typeWriter = function(text) {
Â  Â  const chatDiv = $('chat');
Â  Â  const brand = $('brandWrapper');
Â  Â  if(!chatDiv) return;
Â  Â Â 
Â  Â  if(brand) brand.classList.add('talking');
Â  Â  const bubble = document.createElement("div");
Â  Â  bubble.className = "bubble bot";
Â  Â  chatDiv.appendChild(bubble);

Â  Â  let i = 0;
Â  Â  function type() {
Â  Â  Â  if(i < text.length) {
Â  Â  Â  Â  bubble.textContent += text.charAt(i);
Â  Â  Â  Â  i++;
Â  Â  Â  Â  chatDiv.scrollTop = chatDiv.scrollHeight;
Â  Â  Â  Â  setTimeout(type, 20);
Â  Â  Â  } else {
Â  Â  Â  Â  if(brand) brand.classList.remove('talking');
Â  Â  Â  }
Â  Â  }
Â  Â  type();
Â  };

Â  // 5. Bildirimler
Â  window.refreshNotifications = async function() {
Â  Â  const list = $('notifList');
Â  Â  const badge = $('notifBadge');
Â  Â  if(!list) return;

Â  Â  try {
Â  Â  Â  const user = JSON.parse(localStorage.getItem(STORAGE_KEY) || "{}");
Â  Â  Â  const res = await fetch(`${BASE_DOMAIN}/api/reminders/today?user_id=${user.id || 'guest'}`);
Â  Â  Â  const data = await res.json();
Â  Â  Â  const items = data.items || [];

Â  Â  Â  if(badge) badge.style.display = items.length ? "block" : "none";

Â  Â  Â  if(!items.length) {
Â  Â  Â  Â  list.innerHTML = `<div class="notif-item"><div class="notif-content"><div class="notif-title">Sakin</div><div class="notif-desc">HatÄ±rlatma yok evladÄ±m.</div></div></div>`;
Â  Â  Â  Â  return;
Â  Â  Â  }

Â  Â  Â  list.innerHTML = items.map(it => `
Â  Â  Â  Â  <div class="notif-item">
Â  Â  Â  Â  Â  <div class="notif-icon">ğŸ””</div>
Â  Â  Â  Â  Â  <div class="notif-content">
Â  Â  Â  Â  Â  Â  <div class="notif-title">${it.title}</div>
Â  Â  Â  Â  Â  Â  <div class="notif-desc">${it.message}</div>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  Â  `).join("");
Â  Â  } catch(e) { console.log("Notif error:", e); }
Â  };

Â  // --- WINDOW ONLOAD (BaÅŸlangÄ±Ã§) ---
Â  window.onload = async function() {
Â  Â  console.log("Caynana v2.7 BaÅŸlatÄ±lÄ±yor...");

Â  Â  // 1. Partials
Â  Â  try { await initPartials(); } catch(e) { console.log("Partials hatasÄ±:", e); }

Â  Â  // 2. Auth Init (Ã–NEMLÄ° EKLENTÄ°)
Â  Â  if(typeof initAuth === 'function') initAuth();

Â  Â  // 3. Notif Init
Â  Â  try { initNotif({ baseUrl: BASE_DOMAIN }); } catch(e) {}

Â  Â  // 4. Session KontrolÃ¼
Â  Â  const user = JSON.parse(localStorage.getItem(STORAGE_KEY) || "{}");
Â  Â  if(user && user.isSessionActive && user.email) {
Â  Â  Â  Â if(!user.terms_accepted_at) $('termsOverlay').classList.add('active');
Â  Â  Â  Â else window.enterApp();
Â  Â  Â  Â $('loginOverlay').classList.remove('active');
Â  Â  }

Â  Â  // 5. Buton ListenerlarÄ±
Â  Â  $('sendBtn')?.addEventListener('click', window.sendMessage);
Â  Â  $('msgInput')?.addEventListener('keydown', (e) => {
Â  Â  Â  if(e.key === 'Enter' && !e.shiftKey) { e.preventDefault(); window.sendMessage(); }
Â  Â  });
Â  Â Â 
Â  Â  // GÃ¶z Takip vb.
Â  Â  setInterval(autoLookBehavior, 5000);
Â  Â  resetIdle();
Â  Â Â 
Â  Â  // Ses TanÄ±ma
Â  Â  window.startDictation = function() {
Â  Â  Â  const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
Â  Â  Â  if (!SpeechRecognition) { alert("Ses desteÄŸi yok."); return; }
Â  Â  Â  const r = new SpeechRecognition();
Â  Â  Â  r.lang = "tr-TR";
Â  Â  Â  r.start();
Â  Â  Â  r.onresult = function(e) {
Â  Â  Â  Â  $('msgInput').value = e.results[0][0].transcript;
Â  Â  Â  Â  r.stop();
Â  Â  Â  Â  window.sendMessage();
Â  Â  Â  };
Â  Â  };
Â  };

Â  // --- GÃ¶z Takip YardÄ±mcÄ±larÄ± ---
Â  let isTracking = false, isMouseActive = false, sleepTimer = null, gazeTimer = null;
Â  const eyeL = $('eyeL'), eyeR = $('eyeR'), frame = $('mobileFrame');

Â  window.toggleCam = function() {
Â  Â  if(!frame) return;
Â  Â  if(frame.classList.contains('tracking-active')) {
Â  Â  Â  frame.classList.remove('tracking-active'); $('camBtn').classList.remove('active'); isTracking = false;
Â  Â  } else {
Â  Â  Â  frame.classList.add('tracking-active'); $('camBtn').classList.add('active'); isTracking = true; wakeUp();
Â  Â  }
Â  };

Â  function setGaze(x, y) {
Â  Â  const gx = Math.min(Math.max(x * 20, -20), 20), gy = Math.min(Math.max(y * 15, -15), 15);
Â  Â  [eyeL, eyeR].forEach(e => { if(e) { e.style.setProperty('--gx', gx+'px'); e.style.setProperty('--gy', gy+'px'); } });
Â  }
Â  function setLids(top, bot=0) {
Â  Â  [eyeL, eyeR].forEach(e => { if(e) { e.style.setProperty('--lidTop', top+'%'); e.style.setProperty('--lidBot', bot+'%'); } });
Â  }
Â  function resetIdle() { clearTimeout(sleepTimer); sleepTimer = setTimeout(goSleep, 30000); }
Â  function goSleep() { if(frame) { frame.classList.add('sleeping'); setLids(100, 100); } }
Â  function wakeUp() { if(frame) { frame.classList.remove('sleeping'); setLids(0, 0); resetIdle(); } }
Â  function centerEyes() { setGaze(0, 0); }
Â  function autoLookBehavior() {
Â  Â  if (!frame || isMouseActive || frame.classList.contains('sleeping') || !isTracking) return;
Â  Â  setGaze((Math.random() - 0.5) * 0.8, (Math.random() - 0.5) * 0.5);
Â  Â  setTimeout(() => setGaze(0, 0), 1000);
Â  }

Â  if(frame) {
Â  Â  window.addEventListener('pointermove', (e) => {
Â  Â  Â  if(!isTracking || frame.classList.contains('sleeping')) { if(frame.classList.contains('sleeping')) wakeUp(); }
Â  Â  Â  resetIdle(); isMouseActive = true; clearTimeout(gazeTimer);
Â  Â  Â  const rect = frame.getBoundingClientRect();
Â  Â  Â  setGaze(((e.clientX - rect.left) / rect.width) * 2 - 1, ((e.clientY - rect.top) / rect.height) * 2 - 1);
Â  Â  Â  gazeTimer = setTimeout(() => { isMouseActive = false; centerEyes(); }, 2000);
Â  Â  });
Â  }
</script>

</body>
</html>
